{% extends "app.html" %}

{% block main %}
<form name="conversation" method="post" action="" id="conversation">
    {% csrf_token %}
    <div id="control-bar">
        <div id="control-elements">
            <h3>
                New Conversation
            </h3>
            <div id="control-bar-right">
                <span class="status">&nbsp;</span><input type="submit" name="submit" class="btn" value="Start Conversation"><input type="button" class="btn-grey" value="Back" onclick="javascript:history.go(-1)">
            </div>
        </div>
    </div>
    <div id="main">
        <div class="inner">
            {% include "base/includes/messages.html" %}
            <div class="notification success show">
                Preview sent...
            </div>
            <div id="progress-bar">
                <ul>
                    <li class="pre-active">Message</li><li class="pre-active">People</li><li class="last-active">Send</li>
                </ul>
            </div>
            <div class="wide-box">
                <div id="conv-box">
                    <label class="group-label-b">Get your message approved:</label>
                    <div id="groups-list">
                        {% for contact in conversation.previewcontacts.all %}
                        {# TODO: implement status, waiting, approved  #}
                        <div class="group approved {% if forloop.first %}first{% endif %}">
                            <span class="group-name">{{contact}}</span>
                        </div>
                        {% endfor %}
                        <input type="submit" name="upload" value="Send Preview" class="btn">
                    </div>
                    {# TODO: implement auto-refresh? #}
                    {# <p> #}
                    {#     You won't need to refresh this page. #}
                    {# </p> #}
                </div>
                <div id="preview-box">
                    <div id="preview-pane">
                        <span class="sender">{{user_profile}}:</span> <span class="preview-message">{{conversation.message}}</span>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
        </div>
    </div>
</form>
{% endblock %}