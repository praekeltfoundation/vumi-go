{% extends "wizard_views/wizard_base.html" %}

{% block content_extraclass %}{{ block.super }} details{% endblock %}

{% block content_title %}New Conversation{% endblock %}

{% block content_main %}
<form id="form-conversation" class="indent" method="post" action="">
    {% csrf_token %}

    {{ form_general }}
    
    <div class="configuration">

        <label>
            How would you like to reach and interact with users?
        </label>

        <fieldset class="configuration_new row-fluid boxes">
            <div class="span4">
                <div class="box">
                    <label for="id_{{ form_config.countries.name }}">
                        {{ form_config_new.countries.label }}
                    </label>

                    {{ form_config_new.countries }}
                </div>
                <button class="btn btn-primary">Add country</button>
            </div>

            <div class="span4">
                <div class="box">
                    <label for="id_{{ form_config.keyword.name }}">
                      {{ form_config_new.channels.label }}
                    </label>
                    {{ form_config_new.channels }}
                </div>
                <button class="btn btn-primary">Add channel</button>
            </div>
            
            <div class="span4">
                <div class="box">
                    <label for="id_{{ form_config.keyword.name }}">
                      {{ form_config_new.keyword.label }}
                    </label>
                    {{ form_config_new.keyword }}
                </div>
            </div>
        </fieldset>

        {# TODO: This form needs to be built in Django land. #}
        <fieldset class="configuration_existing row-fluid boxes">
            <div class="span4">
                <div class="box">
                    <label for="id_channel">
                        Select an existing channel
                    </label>
                    <select name="channel" id="id_channel">
                        <option value=""></option>
                        <option value="">Channel A</option>
                        <option value="">Channel B</option>
                    </select>
                </div>
            </div>

            <div class="span4">
                <div class="box">
                    <label for="id_keyword">
                      Define a new keyword
                    </label>
                    <input type="text" name="keyword" id="id_keyword">
                </div>
            </div>
            
            <div class="span4">
                <div class="box">
                    <label for="">
                      Your existing keywords
                    </label>

                    Dan, Sam, Plan, Rodger, Pink, Rabble.
                </div>
            </div>
        </fieldset>

    </div>
</form>
{% endblock %}


{% block ondomready %}
    {{ block.super }}
    
    // if a channel is already selected then we should show the
    // configuration view for it.
    $('input[name=channel]:checked').trigger('change');

    $('input[name=channel]').on('change', function() {
        $('.configuration').show();
        $('.configuration fieldset').hide();
        var $el = $('.configuration_' + $(this).attr('value'));
        $el.show();
    });

    // TODO: form validation.


{% endblock %}
