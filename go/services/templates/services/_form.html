{% load go_tags %}
{% load i18n %}

{% if form.config.as_modal %}
<div class="modal-dialog">
    <div class="modal-content">
{% endif %}

        <form method="{% firstof form.config.method "POST" %}"
              action="{% firstof form.config.action request.get_full_path %}"
              enctype="multipart/form-data">

            {% if form.config.as_modal %}
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">{{ form.config.title }}</h4>
            </div>
            <div class="modal-body">
            {% endif %}

                {% csrf_token %}
                {% for field in form.hidden_fields %}{{ field }}{% endfor %}
                <div class="form-messages">
                    {% for error in form.non_field_errors %}
                    <p class="error">{{ error }}</p>
                    {% endfor %}
                    {% for message in form.messages %}
                    <p class="message">{% autoescape off %}{{ message }}{% endautoescape %}</p>
                    {% endfor %}
                </div>
                {% for field in form.visible_fields %}
                <div class="form-group{% if field.errors %} error{% endif %}">
                    <label class="control-label" for="id_{{ field.name }}">
                        {% if form.visible_fields|length > 1 %}{{ forloop.counter }})&nbsp;{% endif %}
                        {{ field.label }}
                    </label>
                    <div class="controls">
                        {{ field|attr_class:"form-control" }}
                        {% if field.errors %}
                        <ul class="errorlist">
                            {% for error in field.errors %}
                            <li><span class="help-block">{{ error }}</span></li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                    <div class="help-text">
                        {% autoescape off %}{{ field.help_text }}{% endautoescape %}
                    </div>
                </div>
                {% endfor %}

            {% if form.config.as_modal %}
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-primary">
                    {% if form.config.submit_text %}{{ form.config.submit_text }}{% else %}{% trans "Submit" %}{% endif %}
                </button>
                <button type="button" class="btn btn-default" data-dismiss="modal">{% trans "Close" %}</button>
            </div>
            {% else %}
            <button type="submit" class="btn btn-primary">
                {% if form.config.submit_text %}{{ form.config.submit_text }}{% else %}{% trans "Submit" %}{% endif %}
            </button>
            {% endif %}

        </form>

{% if form.config.as_modal %}
    </div>
</div>
{% endif %}
